# Airflow Pipeline

–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è ML-–º–æ–¥–µ–ª–∏.

```
‚îú‚îÄüìÅ dags ------------- # —à–∞–±–ª–æ–Ω DAG‚Äô–∞
‚îÇ‚ÄÉ‚îî‚îÄ ...
‚îú‚îÄüìÅ data ------------- # –¥–∞–Ω–Ω—ã–µ
‚îÇ‚ÄÉ‚îú‚îÄüìÅ models --------- # ML-–º–æ–¥–µ–ª–∏
‚îÇ‚ÄÉ‚îú‚îÄüìÅ predictions ---- # –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
‚îÇ‚ÄÉ‚îú‚îÄüìÅ test ----------- # –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ‚ÄÉ‚îî‚îÄüìÅ train ---------- # –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄüìÅ modules
‚îÇ‚ÄÉ‚îú‚îÄüìÑ pipeline.py ---- # –∫–æ–¥ ML-–º–æ–¥–µ–ª–∏
‚îÇ‚ÄÉ‚îî‚îÄüìÑ predict.py ----- # —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞

```

### Apache Airflow

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–≤–ª–µ—á–µ–Ω–∏—è, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö (ETL). Airflow –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

–†–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤ Apache Airflow ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä –∑–∞–≤–∏—Å—è—â–∏—Ö –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –∑–∞–¥–∞—á. Airflow –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞—Ñ—ã (DAG) –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.

–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–ø—É—Å–∫ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤ (DAG Run) –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö DAG–æ–≤ (–≤ —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ –≤—ã –ø–∏—à–∏—Ç–µ –Ω–æ–≤—ã–µ –ø–∞–π–ø–ª–∞–π–Ω—ã –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç–µ –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é). –ë–µ–∑ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å DAG.

```
# create db
airflow db init

# create default  admin
airflow users create \
    --username airflow \
    --firstname Airflow \
    --lastname Apache \
    --role Admin \
    --email airflow@example.com \
    --password airflow

# open webserver at http://127.0.0.1:8080
airflow webserver -p 8080

# update Dag with scheduler
airflow scheduler

# reset db
airflow db reset
```

### –•—É–∫–∏

–•—É–∫–∏ - —ç—Ç–æ —Å–∫—Ä–∏–ø—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π.

[Pre-commit](https://pre-commit.com/) - —ç—Ç–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ö—É–∫–æ–≤ (–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤) –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –∫–æ–º–º–∏—Ç–∞. Pre-commit –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ —Ö—É–∫–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –∏ –∫–∞–∫ –∏—Ö –∑–∞–ø—É—Å–∫–∞—Ç—å. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –∏ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤.

`pip install pre-commit==3.8.0`(—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–∫–æ–º–º–∏—Ç)

`pre-commit install`(–¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–∫–æ–º–º–∏—Ç)

`pre-commit run --all-files`(–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–∑ –∫–æ–º–º–∏—Ç–∞)

`git commit --no-verify` (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ö—É–∫–∞ –ø—Ä–∏ –∫–æ–º–º–∏—Ç–µ)
